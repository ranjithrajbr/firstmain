/* =================================
* jQuery parallax v1.2 / Copyright Â© 2014 Spab Rice
* All rights reserved.
================================= */
jQuery(window).load(function(){
	setTimeout(function() { 
	//bugfix jumping on first scroll
	jQuery('html,body').animate({ scrollTop: jQuery(window).scrollTop()+1},5, function(){
		jQuery('html,body').animate({ scrollTop: jQuery(window).scrollTop()-1}, 5);
	}); 
	},2000);
});
	
(function (e) {
	e.fn.extend({
		parallax: function (e) {
			return this.each(function () {
				var e = jQuery(this);
				
				setTimeout(function() { var img = new Image();
				img.onload = function() { imgH = this.height; imgW = this.width; e.data("imagewidth",imgW); e.data("imageheight",imgH); }
				img.src = e.data("parallax-image");},500);
				
				if (jQuery(window).width() > 1024) {
					e.css({
						background: "url(" + e.data("parallax-image") + ") center center",
						"background-attachment": "fixed"
					});
					setTimeout(function() { moveParallax(e); }, 500);
					jQuery(window).scroll(function () {
						moveParallax(e)
					})
				} else {
					e.css({
						background: "url(" + e.data("parallax-image") + ") center center",
						"background-attachment": "inherit",
						"background-size": "cover"
					})
				}
			})
		}
	})
})(jQuery)

function moveParallax(e) {
	var t = jQuery(e).visible(true);
	if (t) {
		var n = jQuery(e).data("imagewidth");
		var h = jQuery(e).data("imageheight");
		var f = jQuery(e).data("speed");
		var r = jQuery(e).width();
		var i = jQuery(e).offset().left;
		var s = jQuery(window).width();
		var q = jQuery(window).height();
		if (n && (s-200>r)) {
			preLeft = i - Math.round(s / 2) + Math.round(r / 2);
			leftPos = Math.round((n - s) / 2);
			leftPos = preLeft + -leftPos + "px";
		} else {
			leftPos = "50%"
		}
		if (h && h>q) {
			topPos = Math.ceil((h-q)/2);
		} else {
			topPos = "0";
		}
		if (f) {}else{ f=0.3; }		
		var o = parseInt(jQuery(e).offset().top);
		var u = o - jQuery(window).scrollTop();
		var a = (u * f) - topPos;
		var f = leftPos + " " + a + "px";
		jQuery(e).css({
			backgroundPosition: f
		})
	}
}